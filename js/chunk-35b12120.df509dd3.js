(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-35b12120"],{"68a4":function(e,t,s){},"6d6d":function(e,t,s){"use strict";s("68a4")},ee79:function(e,t,s){"use strict";s.r(t);s("b0c0");var i=s("7a23"),c=Object(i["G"])("data-v-44736ffc");Object(i["u"])("data-v-44736ffc");var r={class:"h-100 w-100"},a={key:0,class:"h-100 w-100 container"},n=Object(i["i"])("br",null,null,-1),o={key:0,class:"ms-3 mb-4"},l={class:"pt-1"},u={key:1},h=Object(i["i"])("h1",{class:"ms-3 mb-4"},"Add friends to chat",-1),d={key:1,class:"w-100 h-100 d-flex",style:{"flex-direction":"column",overflow:"auto"}},m={class:"me-4"},g={class:"mt-2 title-name"},b=Object(i["i"])("br",null,null,-1),f={key:0},p={key:1},j=Object(i["i"])("div",{class:"flex-fill"},null,-1),O={class:"p-2"},w=Object(i["i"])("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",fill:"currentColor",class:"bi bi-telephone-fill",viewBox:"0 0 16 16"},[Object(i["i"])("path",{"fill-rule":"evenodd",d:"M1.885.511a1.745 1.745 0 0 1 2.61.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.678.678 0 0 0 .178.643l2.457 2.457a.678.678 0 0 0 .644.178l2.189-.547a1.745 1.745 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.634 18.634 0 0 1-7.01-4.42 18.634 18.634 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877L1.885.511z"})],-1),v={class:"d-flex p-2 h-100 chat-wrapper flex-fill",style:{"flex-direction":"column",overflow:"auto"}},$={class:"d-flex"},k={class:"text-break",style:{"white-space":"pre-wrap"}},y={class:"mb-1 d-flex"},x={class:"me-3"},C={class:"text-muted mt-0",style:{"font-size":"15px"}},I={class:"mt-1"},U={ref:"afterChat"},A={key:0,class:"progress-line border-progress-line"},M={class:"w-100 wrapper-input"},S=Object(i["i"])("button",{type:"submit",class:"btn btn-primary"},"Send",-1);Object(i["s"])();var T=c((function(e,t,s,c,T,_){return Object(i["r"])(),Object(i["f"])("div",r,["main"==e.$route.params.id?(Object(i["r"])(),Object(i["f"])("div",a,[n,0!=e.$store.getters["user"].channels?(Object(i["r"])(),Object(i["f"])("h1",o," Select a friend to chat ")):Object(i["g"])("",!0),(Object(i["r"])(!0),Object(i["f"])(i["a"],null,Object(i["x"])(e.$store.getters["user"].channels,(function(t,s){return Object(i["r"])(),Object(i["f"])("div",{key:s,class:"user-card p-2 pb-0 d-flex",onClick:function(s){e.$router.push("/channels/chat/"+t.channel),e.$store.commit("setChatId",t.channel)}},[Object(i["i"])("img",{src:e.$store.getters["api"]+"/profiles/"+t.user.image,height:"55",width:"55",alt:"User image",class:"me-4 rounded-circle"},null,8,["src"]),Object(i["i"])("div",l,[Object(i["i"])("strong",null,Object(i["A"])(t.user.name),1),Object(i["i"])("p",null,Object(i["A"])(t.user.desc),1)])],8,["onClick"])})),128)),0==e.$store.getters["user"].channels?(Object(i["r"])(),Object(i["f"])("div",u,[h,Object(i["i"])("button",{class:"ms-3 btn btn-primary",onClick:t[1]||(t[1]=function(t){return e.$router.push("/channels/friends")})}," Search friends ")])):Object(i["g"])("",!0)])):(Object(i["r"])(),Object(i["f"])("div",d,[Object(i["i"])("div",{class:["p-2 d-flex top-bar",e.$store.getters["inCall"]?"":"sticky-top"]},[Object(i["i"])("img",{src:e.$store.getters["api"]+"/profiles/"+e.chattingUser.image,alt:"",width:"60",height:"60",class:"me-3 rounded-circle"},null,8,["src"]),Object(i["i"])("div",m,[Object(i["i"])("strong",g,Object(i["A"])(e.chattingUser.name),1),b,e.typing>0?(Object(i["r"])(),Object(i["f"])("div",f,"typing...")):(Object(i["r"])(),Object(i["f"])("div",p,Object(i["A"])(e.chattingUser.desc),1))]),j,Object(i["i"])("div",O,[Object(i["i"])("div",{class:"top-button",onClick:t[2]||(t[2]=function(t){e.$socket.emit("call",e.chattingUser._id,e.$route.params.id,e.$store.getters["user"].image,e.$store.getters["user"].name),e.$store.commit("userEnterCall"),e.$router.push("/channels/call/"+e.$route.params.id)})},[w])])],2),Object(i["i"])("div",v,[(Object(i["r"])(!0),Object(i["f"])(i["a"],null,Object(i["x"])(e.mesages,(function(t,s){return Object(i["r"])(),Object(i["f"])("div",{key:s,class:"p-2 message"},[Object(i["i"])("div",$,[Object(i["i"])("img",{src:e.$store.getters["api"]+"/profiles/"+t.sender.image,height:"50",width:"50",alt:"Profile image",class:"rounded-circle me-3"},null,8,["src"]),Object(i["i"])("div",k,[Object(i["i"])("div",y,[Object(i["i"])("div",x,[Object(i["i"])("strong",null,Object(i["A"])(t.sender.name),1)]),Object(i["i"])("div",C,Object(i["A"])(_.formatMessageData(t.timestamp)),1)]),Object(i["i"])("div",I,Object(i["A"])(t.content),1)])])])})),128)),Object(i["i"])("div",U,null,512)]),e.loading?(Object(i["r"])(),Object(i["f"])("div",A)):Object(i["g"])("",!0),Object(i["i"])("div",M,[Object(i["i"])("form",{onSubmit:t[5]||(t[5]=Object(i["F"])((function(){return _.emit&&_.emit.apply(_,arguments)}),["prevent"])),class:"d-flex flex-wrap"},[Object(i["E"])(Object(i["i"])("input",{"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.message=t}),type:"text",class:"me-2 flex-fill input-mesage",maxlength:"1000",placeholder:" Chat with "+e.chattingUser.name,onKeyup:t[4]||(t[4]=function(t){return e.$socket.emit("write","write"+_.chatId,e.$store.getters["user"]._id)})},null,40,["placeholder"]),[[i["C"],e.message]]),S],32)])]))])})),_=s("c1df"),z=s.n(_),B={data:function(){return{message:"",mesages:[],loading:!1,chattingUser:{image:"default.png"},streams:{},newStream:null,typing:0,peervue:null,peers:{}}},sockets:{connect:function(){console.log("socket connected")},newMessage:function(e){console.log("el server diu",e),this.mesages.push(e)},writing:function(e){console.log(e),e!=this.$store.getters["user"]._id&&this.showTyping()}},methods:{emit:function(){""!=this.message&&(this.$socket.emit("message",this.$route.params.id,this.message,this.$store.getters["user"]),this.axios.post(this.$store.getters["api"]+"/messages/add/"+this.$route.params.id,{message:this.message},{headers:{authorization:"Bearer ".concat(window.localStorage.token)}}).then((function(e){console.log(e)})).catch((function(e){console.error(e)})).then((function(){})),this.message="")},populateMessages:function(){var e=this;console.log("popu"),"main"!=this.chatId&&this.axios.get(this.$store.getters["api"]+"/messages/all/"+this.chatId,{headers:{Authorization:"Bearer ".concat(window.localStorage.token)}}).then((function(t){console.log(t),e.chattingUser=t.data.userToChat,e.mesages=t.data.messages})).catch((function(e){console.error(e)})).then((function(){console.log("Populate messages "),e.$refs.afterChat.scrollIntoView()}))},formatMessageData:function(e){return z()(e).startOf("minute").fromNow()},showTyping:function(){var e=this;this.typing++,setTimeout((function(){return e.typing--}),500)},peer:function(){this.$store.commit("navigateTo","chat"),this.$store.commit("setChatId",this.$route.params.id),this.$store.commit("refreshUser"),this.populateMessages(),this.$socket.emit("join-room",this.$route.params.id),this.$socket.emit("listen-writing","write"+this.$route.params.id)}},mounted:function(){this.peer()},updated:function(){"main"!=this.chatId&&this.$refs.afterChat.scrollIntoView({behavior:"smooth"})},created:function(){},computed:{chatId:function(){return this.$store.getters["lastChatId"]}},watch:{chatId:function(e,t){this.populateMessages(),console.log("test"),this.$socket.emit("leave-room",t),this.$socket.emit("join-room",this.chatId),this.$socket.emit("leave-writing","write"+t),this.$socket.emit("listen-writing","write"+this.chatId),console.log("new user",e,"old user",t)}}};s("6d6d");B.render=T,B.__scopeId="data-v-44736ffc";t["default"]=B}}]);
//# sourceMappingURL=chunk-35b12120.df509dd3.js.map